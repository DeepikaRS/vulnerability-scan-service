package com.vss.app.service.concretions;

import com.vss.app.model.ActionDetails;
import com.vss.app.model.ScanResult;
import com.vss.app.service.abstractions.ITrigger;

public class ScanFailedTrigger implements ITrigger {

    @Override
    public ActionDetails getActionDetails(ScanResult result) {
        return ActionDetails.builder().message
                ("Debricked scan has failed with the following message : " +
                        result.getScanFailedMessage() + " for files " + " The dependency file " + result.getFileNames()).build();
    }

    @Override
    public boolean evaluate(ScanResult result) {
        return result.getScanFailedMessage() != null && !result.getScanFailedMessage().trim().isEmpty();
    }
}

