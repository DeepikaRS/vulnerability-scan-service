package com.vss.app.service.concretions;

import com.vss.app.model.ActionDetails;
import com.vss.app.model.ScanResult;
import com.vss.app.service.abstractions.ITrigger;

public class VulnerabilitiesFoundTrigger implements ITrigger {

    private static final int THRESHOLD = 5;

    @Override
    public ActionDetails getActionDetails(ScanResult result) {
        return ActionDetails.builder().message("Debricked scan found " + result.getVulnerabilitiesCount() + " vulnerabilities in the dependencies submitted." +
                " The dependency file " + result.getFileNames() + "is not considered eligible for integration").build();
    }

    @Override
    public boolean evaluate(ScanResult result) {
        return result.getVulnerabilitiesCount() > THRESHOLD;
    }
}

