package com.vss.app.model;

import com.vss.app.service.abstractions.IAction;
import com.vss.app.service.abstractions.ITrigger;

import java.util.List;

public class Rule {

    private final ITrigger trigger;
    private final List<IAction> actions;

    public Rule(ITrigger trigger, List<IAction> actions) {
        this.trigger = trigger;
        this.actions = actions;
    }

    public boolean isTriggered(ScanResult result) {
        return trigger.evaluate(result);
    }

    public void executeAction(ScanResult result) {
        for(IAction action : actions) {
            ActionDetails actionDetails = trigger.getActionDetails(result);
            action.execute(actionDetails);
        }
    }


}

