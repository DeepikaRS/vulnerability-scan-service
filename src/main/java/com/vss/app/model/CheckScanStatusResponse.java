package com.vss.app.model;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import lombok.Data;

import java.util.List;

@JsonIgnoreProperties(ignoreUnknown = true)
@Data
public class CheckScanStatusResponse {

    private int progress;
    private int vulnerabilitiesFound;
    private int unaffectedVulnerabilitiesFound;
    private String automationsAction;
    private String policyEngineAction;
    private List<AutomationRule> automationRules;
    private String detailsUrl;

    // Inner classes

    @JsonIgnoreProperties(ignoreUnknown = true)
    @Data
    public static class AutomationRule {
        private String ruleDescription;
        private List<String> ruleActions;
        private String ruleLink;
        private boolean hasCves;
        private boolean triggered;
        private List<TriggerEvent> triggerEvents;
    }

    @JsonIgnoreProperties(ignoreUnknown = true)
    @Data
    public static class TriggerEvent {
        private String dependency;
        private String dependencyLink;
        private List<String> licenses;
        private String cve;
        private String cveLink;
        private double cvss2;
        private double cvss3;
    }

}
